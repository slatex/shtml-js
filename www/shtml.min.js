var SHTML_CSS=void 0;function shtml_init_css(){if(!SHTML_CSS){(SHTML_CSS=document.createElement("style")).setAttribute("type","text/css"),SHTML_CSS.styleSheet&&(SHTML_CSS.styleSheet.cssText=""),document.head.appendChild(SHTML_CSS);var t=shtml_get_css_classes(),e=[".shtml-varcomp",".shtml-symcomp",".shtml-definiendum",".shtml-tooltip",".shtml-on-hover"];shtml_add_style((e=e.filter((function(e){return!t.includes(e)}))).map((function(t){switch(t){case".shtml-varcomp":return".shtml-varcomp { color: #828282; }";case".shtml-symcomp":return".shtml-symcomp { color: #0e90d2; }";case".shtml-definiendum":return".shtml-definiendum { color: #ed028c; }";case".shtml-tooltip":return".shtml-tooltip { position: absolute; display: none; background:#f9f9f9; border:1px solid #ccc }";case".shtml-on-hover":return".shtml-on-hover { background-color: yellow; cursor: pointer;display:inline }"}})).join("\n"))}}function shtml_add_style(t){SHTML_CSS||shtml_init_css(),SHTML_CSS.styleSheet?SHTML_CSS.styleSheet.cssText+=t:SHTML_CSS.appendChild(document.createTextNode(t))}function shtml_get_css_classes(){for(var t=[],e=0;e<document.styleSheets.length;e++){var o=document.styleSheets[e],s=null;try{s=o.cssRules||o.rules}catch(t){console.warn("Cannot read cssRules from stylesheet; likely due to same-origin policy.",t);continue}for(var n=0;n<s.length;n++){var a=s[n];a instanceof CSSStyleRule&&t.push(a.selectorText)}}return t}var WINDOW=window,HTML_NS="http://www.w3.org/1999/xhtml",MATHML_NS="http://www.w3.org/1998/Math/MathML",SHTML_NS="http://kwarc.info/ns/SHTML";WINDOW.SHTML_SERVER||(WINDOW.SHTML_SERVER="https://stexmmt.mathhub.info/:sTeX");var SHTML_LISTENER=new MutationObserver((function(t){t.forEach((function(t){t.addedNodes.forEach((function(t){t.nodeType===Node.ELEMENT_NODE&&do_shtml(t)}))}))}));function shtml_initialize(){shtml_init_css()}document.addEventListener("DOMContentLoaded",(function(){SHTML_LISTENER.observe(document.body,{childList:!0,subtree:!0}),shtml_initialize(),do_shtml(document.body)}));var SHTMLTerm,definitionsMap=new Map;function do_shtml(t){for(var e=function(){t.childNodes.forEach((function(t){t.nodeType===Node.ELEMENT_NODE&&do_shtml(t)}))},o=0;o<t.attributes.length;o++){var s=t.attributes[o];if(s.name.startsWith("shtml:")){var n=s.name.substring(6);switch(n){case"visible":if("false"===s.value)return;case"definiendum":t.classList.add("shtml-definiendum");break;case"sourceref":case"doctitle":case"sectionlevel":case"metatheory":case"language":case"signature":case"import":case"id":case"inline":case"statementtitle":case"vardef":case"definiens":case"notationid":case"head":case"fors":case"argmode":case"arg":case"macroname":break;case"theory":return shtml_do_theory(t),void e();case"term":return void shtml_do_term(t);case"feature-structure":return shtml_do_mathstructure(t),void e();case"definition":return shtml_do_definition(t),void e();default:console.log("SHTML attribute not implemented: ",n)}}}e()}function shtml_do_theory(t){var e,o,s=null===(e=t.attributes.getNamedItem("shtml:theory"))||void 0===e?void 0:e.value,n=null===(o=t.attributes.getNamedItem("shtml:metatheory"))||void 0===o?void 0:o.value;console.log("SHTML theory: ".concat(s," : ").concat(n))}function shtml_do_mathstructure(t){var e,o,s=null===(e=t.attributes.getNamedItem("shtml:feature-structure"))||void 0===e?void 0:e.value,n=null===(o=t.attributes.getNamedItem("shtml:macroname"))||void 0===o?void 0:o.value;console.log("SHTML mathstructure: ".concat(s," (\\").concat(n,")"))}function shtml_do_definition(t){var e,o=null===(e=t.attributes.getNamedItem("shtml:fors"))||void 0===e?void 0:e.value.split(",").map((function(t){return t.trim()}));o&&(console.log("SHTML definition for: ",o),o.forEach((function(e){definitionsMap.set(e,t)})))}function shtml_do_term(t){var e=shtml_parse_term_kind(t),o=shtml_get_term_components(t);o.args.forEach((function(t){do_shtml(t)})),shtml_tooltip_inc(),o.components.forEach((function(t){switch(e){case SHTMLTerm.OMV:case SHTMLTerm.OMA_OMV:case SHTMLTerm.OMB_OMV:shtml_add_tooltip(t,"Variable ".concat(o.symbolname),o.components),t.classList.add("shtml-varcomp");break;default:shtml_add_tooltip(t,"Symbol ".concat(o.symbolname),o.components),t.classList.add("shtml-symcomp")}}))}function shtml_parse_term_kind(t){var e,o,s=null===(e=t.attributes.getNamedItem("shtml:term"))||void 0===e?void 0:e.value,n=(null===(o=t.attributes.getNamedItem("shtml:head"))||void 0===o?void 0:o.value).split("?").length>1;switch(s){case"OMID":return n?SHTMLTerm.OMID:SHTMLTerm.OMV;case"OMV":return SHTMLTerm.OMV;case"OMA":return n?SHTMLTerm.OMA_OMID:SHTMLTerm.OMA_OMV;case"OMB":return n?SHTMLTerm.OMB_OMID:SHTMLTerm.OMB_OMV}}!function(t){t[t.OMID=0]="OMID",t[t.OMV=1]="OMV",t[t.OMA_OMID=2]="OMA_OMID",t[t.OMA_OMV=3]="OMA_OMV",t[t.OMB_OMID=4]="OMB_OMID",t[t.OMB_OMV=5]="OMB_OMV"}(SHTMLTerm||(SHTMLTerm={}));var SHTMLTermData=function(){};function shtml_get_term_components(t){var e,o=[],s=[],n=null===(e=t.attributes.getNamedItem("shtml:head"))||void 0===e?void 0:e.value;return function t(e){if(e.attributes.getNamedItem("shtml:arg"))s.push(e);else{var n=e.attributes.getNamedItem("shtml:comp");n||(n=e.attributes.getNamedItem("shtml:maincomp"))||(n=e.attributes.getNamedItem("shtml:varcomp"))?o.push(e):e.childNodes.forEach((function(e){e.nodeType===Node.ELEMENT_NODE&&t(e)}))}}(t),{components:o,args:s,symbolname:n}}var tooltip_counter=0,tooltip_created=!1;function shtml_tooltip_inc(){tooltip_created&&(tooltip_counter++,tooltip_created=!1)}function shtml_add_tooltip(t,e,o){var s="shtml-tooltip-".concat(tooltip_counter);if(!tooltip_created){tooltip_created=!0;var n=document.createElement("div");n.setAttribute("id",s),n.setAttribute("class","shtml-tooltip"),n.innerText=e,document.body.appendChild(n)}t.addEventListener("mouseover",(function(t){return shtml_on_hover(s,o,t)})),t.addEventListener("mousemove",(function(t){return shtml_hover_move(s,t)})),t.addEventListener("mouseout",(function(t){return shtml_end_hover(s,o)}))}function shtml_on_hover(t,e,o){e.forEach((function(t){t.classList.add("shtml-on-hover")}));var s=document.getElementById(t);s.style.display="block",s.style.left=o.pageX+"px",s.style.top=o.pageY+"px"}function shtml_end_hover(t,e){e.forEach((function(t){t.classList.remove("shtml-on-hover")})),document.getElementById(t).style.display="none"}function shtml_hover_move(t,e){var o=document.getElementById(t);o.style.left=e.pageX+"px",o.style.top=e.pageY+"px"}function shtml_is_mathml(t){for(var e=t;e;){if(e.namespaceURI===MATHML_NS)return!0;if(e.namespaceURI===HTML_NS)return!1;e=e.parentNode}}